node{
  stage('git checkout'){
    git credentialsId: 'GITCredential', url: 'https://github.com/RSI1982/netcore-boilerplate.git'
  }
  stage('begain analysis'){
    def sqScannerMsBuildHome = tool name: 'SQ', type: 'hudson.plugins.sonar.MsBuildSQRunnerInstallation'
    withSonarQubeEnv(credentialsId: '4b337e56-fea3-4226-a982-bdbfc2c0b68d', installationName: 'mssonarqube') {
    // some block
    sh label: '', script: 'dotnet $sqScannerMsBuildHome} begin /k:"Awesomekey" /d:sonar.host.url="http://40.68.188.150" /d:sonar.login="34c71aaff3b6c91867c07616e864c6c832da85c0"'
    sh label: '', script: 'dotnet restore src/HappyCode.NetCoreBoilerplate.Core/HappyCode.NetCoreBoilerplate.Core.csproj'
    sh label: '', script: 'dotnet test test/HappyCode.NetCoreBoilerplate.Core.UnitTests/HappyCode.NetCoreBoilerplate.Core.UnitTests.csproj'
    sh label: '', script: 'dotnet build HappyCode.NetCoreBoilerplate.sln'
    sh label: '', script: 'dotnet $sqScannerMsBuildHome} end /d:sonar.login="34c71aaff3b6c91867c07616e864c6c832da85c0"'
  }
  
}
